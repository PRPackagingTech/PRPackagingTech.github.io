<html>
<head>
    <title>Design Box</title>

    <style>
    	body{
    		margin: 0;
    		overflow: hidden;
    	}
    </style>
</head>
<body>

    <canvas id="myCanvas"></canvas>

    <script src="../Javascript/three.js"></script>
		<script src="..\Javascript\orbitControls.js"></script>

    <script>

    var windowHalfX = window.innerWidth / 2;
    var windowHalfY = window.innerHeight / 2;

    var renderer,
    	scene,
    	camera,
    	myCanvas = document.getElementById('myCanvas');

    //RENDERER
    renderer = new THREE.WebGLRenderer({
      canvas: myCanvas,
      antialias: true
    });
    renderer.setClearColor(0x000000);
    renderer.setPixelRatio(window.devicePixelRatio);
    renderer.setSize(window.innerWidth, window.innerHeight);

    //CAMERA
    camera = new THREE.PerspectiveCamera(35, window.innerWidth / window.innerHeight, 0.1, 1000 );
    camera.position.set(5,2.5,2.5);

    //SCENE
    scene = new THREE.Scene();

    //LIGHTS
    var light = new THREE.AmbientLight(0xffffff, 0.5);
    scene.add(light);

    var light2 = new THREE.PointLight(0xffffff, 0.5);
    scene.add(light2);

    //controls
    controls = new THREE.OrbitControls(camera, renderer.domElement);

    //LOAD MODEL
    var loader = new THREE.JSONLoader();
    loader.load('../Models/0215closed.json', handle_load);
    loader.load('../Models/0215open.json', handle_load);
    loader.load('../Models/0215.json', handle_load);

    //LOAD TEXTURES
    var textures = [];
    textures.push(new THREE.TextureLoader().load("../Images/0215closedv2.png"));
    textures.push(new THREE.TextureLoader().load("../Images/0215openv2.png"));
    textures.push(new THREE.TextureLoader().load("../Images/0215v4.png"));

    //clean up
    var materials = [];

    for(var i = 0; i < 3; i++)
    {
      materials.push(new THREE.MeshLambertMaterial({map: textures[i], transparent: true, opacity: 1, side: THREE.DoubleSide}));
    }

    var mesh = [];

    function handle_load(geometry) {

        //BASIC MESH
        //var material = new THREE.MeshNormalMaterial(materials);

        mesh.push(new THREE.Mesh(geometry, materials[mesh.length]));

        scene.add(mesh[mesh.length - 1]);
        mesh[mesh.length - 1].position.z = 0;
        mesh[mesh.length - 1].scale.set(1, 1, 1);

        if(mesh[0] != null) mesh[0].visible = false;
        if(mesh[2] != null) mesh[2].visible = false;

    }

    //RENDER LOOP
    render();

    //var frame = 0;

    function render() {

      controls.update();

      /*frame++;

      if(frame > 120)
      {
        material1.map = texture1;
        material1.needsUpdate = true;
      }
      if(frame > 240)
      {
        material1.map = texture2;
        material1.needsUpdate = true;
        frame = 0;
      }*/

    	requestAnimationFrame(render);

    	renderer.render(scene, camera);
    }

    </script>
</body>
</html>
